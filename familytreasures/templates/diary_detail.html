{% extends 'base.html' %}

    {% block content %}
        <!-- <h1>日記詳細</h1> -->
        <!-- <h1>{{ diary.child.name }}の日記詳細</h1> -->
        <p>投稿者: {{ diary.user.user_name }}</p>
        <p>投稿日: {{ diary.created_at }}</p>
        <p>天気: {{ diary.weather }}  <!-- もし天気を追加するなら対応するフィールドを追加 --> </p>
        <p>気持ち: {{ diary.stamp.name }}</p>
        {% if diary.stamp.image %}
        <img src="{{ diary.stamp.image.url }}" alt="{{ diary.stamp.name }}のスタンプ">
        {% else %}
        <p>スタンプの画像がありません</p> <!-- デバッグ用に表示 -->
        {% endif %}

        <p>内容: {{ diary.content }}</p>

        <h3>メディアファイル</h3>
        {% for media in diary.diarymedia_set.all %}
            {% if media.media_type == 'image' %}
                <!-- <img src="{{ media.media_url }}" alt="Image"> -->
                <img src="{{ media.media_file.url }}" alt="Image">
        {% elif media.media_type == 'video' %}
            <video controls>
                <!-- <source src="{{ media.media_url }}" type="video/mp4"> -->
                <source src="{{ media.media_file.url }}" type="video/mp4">
            </video>
        {% endif %}
    {% endfor %}

<h3>コメント</h3>
<ul></ul>
{% for comment in comments %}
    <li>
        <strong>{{ comment.user.user_name }}:</strong> {{ comment.content }}
        {% if request.user == comment.user %}
            <!-- 編集・削除リンク -->
            <a href="{% url 'app:comment_edit' comment.pk %}">編集</a>
            <a href="{% url 'app:comment_delete' comment.pk %}">削除</a>
        {% endif %}
    </li>
{% empty %}
    <li>コメントはまだありません。</li>
{% endfor %}
</ul>

<a href="{% url 'app:diary_edit' diary.pk %}">日記の編集</a> 
<a href="{% url 'app:diary_delete' diary.pk %}">日記の削除</a> 
<a href="{% url 'app:comment_create' diary.pk %}">コメントを追加</a>
{% endblock %}