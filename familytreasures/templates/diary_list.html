{% extends 'base.html' %}

{% block title %}
日記一覧
{% endblock %}

{% block content %}
    <!-- CSSファイルの読み込み -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/diary_list.css' %}">

    <!-- 日記一覧のコンテナ開始 -->
    <div class="diary-list-container">

        <!-- 子供選択のプルダウンメニュー -->
        <form method="get" action="">
            <label for="child_select">子供を選択:</label>
            <select name="child" id="child_select" onchange="this.form.submit()">
                <option value="all" {% if selected_filter == 'all' or not selected_filter %}selected{% endif %}>すべての</option>
                <option value="none" {% if selected_filter == 'none' %}selected{% endif %}>みんな</option>
                {% for child in children %}
                    <option value="{{ child.id }}" {% if selected_filter == child.id|stringformat:"s" %}selected{% endif %}>{{ child.child_name }}</option>
                {% endfor %}
            </select>
        </form>

        <!-- 年月の表示 -->
        {% if diaries %}
        <div class="year-section">
            <h3>{{ diaries.0.entry_date|date:"Y年" }}</h3>
        </div>
        {% endif %}

        <!-- 日記の一覧 -->
        <ul>
            {% for diary in diaries %}
                <li>
                    <!-- リンク全体をクリック可能にする -->
                    <a href="{% url 'app:diary_detail' diary.pk %}" class="diary-link">
                        <!-- 日付部分 -->
                        <div class="diary-date">
                            <p>{{ diary.entry_date|date:"D" }}</p> <!-- 曜日 -->
                            <p>{{ diary.entry_date|date:"d日" }}</p> <!-- 日付 -->
                        </div>

                        <!-- 内容部分を日付の隣に寄せて表示 -->
                        <div class="diary-content">
                            <h2>
                                {% if diary.child %}
                                    {{ diary.child.child_name }}の日記
                                {% else %}
                                    みんなの日記
                                {% endif %}
                            </h2>
                            {% if diary.content %}
                                <p>内容: {{ diary.content }}</p>
                            {% endif %}
                            {% if diary.template %}
                                <p>一言: {{ diary.template.text }}</p>
                            {% endif %}
                        </div>

                        <!-- 画像を右に表示 -->
                        <div class="diary-image">
                            {% if diary.first_image %}
                                <img src="{{ diary.first_image.media_file.url }}" alt="画像">
                            {% endif %}
                        </div>
                    </a>
                </li>
            {% endfor %}
        </ul>

    </div> <!-- 日記一覧のコンテナ終了 -->
{% endblock %}
